//##fail_test
import "../imports/arena_allocated_box_nullable.u"

fn nomangle main() call_conv( "C" ) : i32
{
	{ // Constructor holds a reference to allocator instance.
		var ust::arena_allocator mut allocator;
		var ust::arena_allocated_box_nullable</i32/> b( allocator, 4 );
		move( allocator ); //##expect_error MovedVariableHasReferences
	}
	{ // Can't mutate stored value having "imut" reference.
		var ust::arena_allocator mut allocator;
		var ust::arena_allocated_box_nullable</i32/> b( allocator, 4 );
		++b.try_deref(); //##expect_error ExpectedMutableReference
	}
	{ // Has no "deref" method.
		var ust::arena_allocator mut allocator;
		var ust::arena_allocated_box_nullable</i32/> b( allocator, 4 );
		b.deref(); //##expect_error NameNotFound
	}

	return 0;
}
